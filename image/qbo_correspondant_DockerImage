# Use the official lightweight Node.js 20 image based on Alpine Linux
FROM node:20-alpine

# Install git so we can clone repositories inside the container
RUN apk add --no-cache git

# Set working directory inside the container to /apps
WORKDIR /apps

# Clone your GitHub repository into /apps/qbo_correspondant folder
RUN git clone https://github.com/dswhaley/qbo_correspondant.git

# Change working directory to the cloned repository
WORKDIR /apps/qbo_correspondant

# Install all dependencies listed in package.json including devDependencies
RUN npm install

# Expose port 3000 so Docker knows which port the app listens on
EXPOSE 3000

# Start the app using ts-node to run TypeScript files directly
CMD ["npx", "ts-node", "src/index.ts"]
